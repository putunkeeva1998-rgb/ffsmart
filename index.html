<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FFMSC Smart –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-bg: var(--tg-theme-bg-color, #ffffff);
            --tg-secondary-bg: var(--tg-theme-secondary-bg-color, #f4f4f4);
            --tg-text: var(--tg-theme-text-color, #000000);
            --tg-link: var(--tg-theme-link-color, #007bff);
            --tg-button: var(--tg-theme-button-color, #2481cc);
            --tg-button-text: var(--tg-theme-button-text-color, #ffffff);
        }

        html, body {
            height: 100vh;
            margin: 0;
            padding: 0;
            overflow: hidden; 
            display: flex;
            flex-direction: column;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--tg-bg);
            color: var(--tg-text);
        }

        header {
            background: var(--tg-button);
            color: var(--tg-button-text);
            padding: 10px;
            font-size: 1.1rem;
            text-align: center;
            flex-shrink: 0;
            font-weight: bold;
        }

        nav {
            display: flex;
            gap: 5px;
            padding: 5px;
            flex-shrink: 0;
        }

        nav button {
            flex: 1;
            padding: 10px;
            font-size: 0.85rem;
            border: none;
            border-radius: 10px;
            background: var(--tg-secondary-bg);
            color: var(--tg-text);
            cursor: pointer;
        }

        nav button.active {
            background: var(--tg-button);
            color: var(--tg-button-text);
        }

        section {
            display: none;
            flex-direction: column;
            flex-grow: 1;
            overflow: hidden;
        }

        section.active { display: flex; }

        .table-container {
            flex-grow: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 0 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.82rem;
        }

        th {
            position: sticky;
            top: 0;
            background: var(--tg-secondary-bg);
            z-index: 10;
            padding: 10px 4px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        td {
            padding: 8px 4px;
            border-bottom: 1px solid var(--tg-secondary-bg);
            text-align: center;
        }

        .service-name { text-align: left; width: 50%; line-height: 1.2; }

        input[type=number] {
            width: 55px;
            padding: 6px;
            border: 1px solid var(--tg-secondary-bg);
            border-radius: 8px;
            background: var(--tg-secondary-bg);
            color: var(--tg-text);
            text-align: center;
            font-size: 0.9rem;
        }

        .results-footer {
            background: var(--tg-secondary-bg);
            padding: 12px;
            flex-shrink: 0;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -4px 12px rgba(0,0,0,0.1);
        }

        .res-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
            font-size: 0.85rem;
        }

        .final-price-box {
            text-align: center;
            margin: 8px 0;
        }

        .final-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--tg-link);
        }

        .action-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: var(--tg-button);
            color: var(--tg-button-text);
            font-weight: bold;
            font-size: 1rem;
        }
    </style>
</head>
<body>

<header>FFMSC Smart –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</header>

<nav>
    <button onclick="showSection('calc', this)" class="active">üì¶ –†–∞—Å—á–µ—Ç</button>
    <button onclick="showSection('address', this)">üìç –ê–¥—Ä–µ—Å</button>
    <button onclick="showSection('contacts', this)">‚òéÔ∏è –°–≤—è–∑—å</button>
</nav>

<section id="calc" class="active">
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th class="service-name">–£—Å–ª—É–≥–∞</th>
                    <th>‚ÇΩ</th>
                    <th>–ö–æ–ª-–≤–æ</th>
                    <th>–°—É–º–º–∞</th>
                </tr>
            </thead>
            <tbody id="serviceTable">
                <tr data-name="–ü—Ä–∏—ë–º–∫–∞">
                    <td class="service-name">–ü—Ä–∏—ë–º–∫–∞ —Ç–æ–≤–∞—Ä–∞</td>
                    <td class="price">2.00</td>
                    <td><input type="number" class="item-count" value="" placeholder="0" oninput="updateTotal()"></td>
                    <td class="lineTotal">0</td>
                </tr>
                <tr data-name="–°–æ—Ä—Ç –ê—Ä—Ç"><td class="service-name">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (–∞—Ä—Ç)</td><td class="price">2.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–°–æ—Ä—Ç –†–∞–∑–º"><td class="service-name">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (—Ä–∞–∑–º)</td><td class="price">2.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–§–∞–±—Ä–∏—á —É–ø–∞–∫"><td class="service-name">–£–±—Ä–∞—Ç—å —É–ø–∞–∫. —Ñ–∞–±—Ä.</td><td class="price">1.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–§–∞–±—Ä –±–∏—Ä–∫–∞"><td class="service-name">–£–±—Ä–∞—Ç—å –±–∏—Ä–∫—É —Ñ–∞–±—Ä.</td><td class="price">1.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ë—Ä–∞–∫ –≤–∏–∑"><td class="service-name">–ë—Ä–∞–∫ (–≤–∏–∑—É–∞–ª—å–Ω–æ)</td><td class="price">10.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–¢—â–∞—Ç –ø—Ä–æ–≤"><td class="service-name">–¢—â–∞—Ç. –ø—Ä–æ–≤. (–Ω–∏—Ç–∫–∏)</td><td class="price">15.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–î–≤–æ–π–∫–∞"><td class="service-name">–ü—Ä–æ–≤–µ—Ä–∫–∞ (–¥–≤–æ–π–∫–∞)</td><td class="price">25.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ë–∏—Ä–∫–∏"><td class="service-name">–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –±–∏—Ä–æ–∫</td><td class="price">8.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–í–ª–æ–∂–µ–Ω–∏–µ"><td class="service-name">–í–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞</td><td class="price">2.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–°–±–æ—Ä–∫–∞ –∫–æ—Ä"><td class="service-name">–°–±–æ—Ä–∫–∞ –∫–æ—Ä–æ–±–∞</td><td class="price">2.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–£–ø–∞–∫–æ–≤–∫–∞"><td class="service-name">–£–ø–∞–∫–æ–≤–∫–∞</td><td class="price">2.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 15"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 15√ó21</td><td class="price">7.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 17"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 17√ó25</td><td class="price">8.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 20"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 20√ó30</td><td class="price">10.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 25"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 25√ó35</td><td class="price">11.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 30x30"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 30√ó30</td><td class="price">12.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 30x40"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 30√ó40</td><td class="price">13.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 35"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 35√ó45</td><td class="price">14.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 40x50"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 40√ó50</td><td class="price">17.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 40x60"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 40√ó60</td><td class="price">18.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 50"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 50√ó70</td><td class="price">21.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ó–∏–ø 60"><td class="service-name">–ó–∏–ø-–ø–∞–∫–µ—Ç 60√ó80</td><td class="price">28.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ú–∞—Ä–∫ —Ç–æ–≤"><td class="service-name">–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–∞</td><td class="price">5.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ú–∞—Ä–∫ —É–ø–∞–∫"><td class="service-name">–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ —É–ø–∞–∫.</td><td class="price">5.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ß–ó —Ç–æ–≤"><td class="service-name">–ß–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫ (—Ç–æ–≤)</td><td class="price">5.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ß–ó —É–ø–∞–∫"><td class="service-name">–ß–µ—Å—Ç–Ω—ã–π –∑–Ω–∞–∫ (—É–ø–∞–∫)</td><td class="price">5.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ö–æ–º–ø–ª–µ–∫—Ç"><td class="service-name">–ö–æ–º–ø–ª–µ–∫—Ç –≤ –∫–æ—Ä–æ–±–∞</td><td class="price">2.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ö–æ—Ä–æ–±"><td class="service-name">–ö–æ—Ä–æ–± (60√ó40√ó40)</td><td class="price">120.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ú–∞—Ä–∫ –∫–æ—Ä"><td class="service-name">–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –∫–æ—Ä–æ–±–∞</td><td class="price">10.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ö–æ–ª–µ–¥–∏–Ω–æ"><td class="service-name">–î–æ—Å—Ç–∞–≤–∫–∞ –ö–æ–ª–µ–¥–∏–Ω–æ</td><td class="price">400.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–ª—å"><td class="service-name">–î–æ—Å—Ç. –≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–ª—å</td><td class="price">450.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–¢—É–ª–∞"><td class="service-name">–î–æ—Å—Ç–∞–≤–∫–∞ –¢—É–ª–∞</td><td class="price">600.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="–ö–∞–∑–∞–Ω—å"><td class="service-name">–î–æ—Å—Ç–∞–≤–∫–∞ –ö–∞–∑–∞–Ω—å</td><td class="price">700.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
                <tr data-name="OZON –ì—Ä–∏–≤–Ω–æ"><td class="service-name">–î–æ—Å—Ç–∞–≤–∫–∞ OZON</td><td class="price">700.00</td><td><input type="number" value="" placeholder="0" oninput="updateTotal()"></td><td class="lineTotal">0</td></tr>
            </tbody>
        </table>
    </div>

    <div class="results-footer">
        <div class="res-row">
            <span>–°–∫–∏–¥–∫–∞ (%): <input type="number" id="discount" value="" placeholder="0" oninput="updateTotal()" style="width: 50px;"></span>
            <span>–ó–∞ 1 –µ–¥: <b id="perItem">0.00</b> ‚ÇΩ</span>
        </div>
        <div class="final-price-box">
            <div style="font-size: 0.75rem; text-transform: uppercase; color: #666;">–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ</div>
            <div class="final-price" id="finalTotal">0.00 ‚ÇΩ</div>
        </div>
        <div style="display: flex; gap: 8px;">
            <button onclick="resetCalc()" class="action-btn" style="background: #e0e0e0; color: #000; flex: 1;">–°–±—Ä–æ—Å</button>
            <button class="action-btn" style="flex: 2;" onclick="sendData()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç</button>
        </div>
    </div>
</section>

<section id="address">
    <div style="padding: 40px 20px; text-align: center;">
        <p style="font-size: 1.2rem;">–≥. –ú–æ—Å–∫–≤–∞, –ß–∞–≥–∏–Ω—Å–∫–∞—è 4 —Å—Ç—Ä 13</p>
        <button class="action-btn" onclick="copyAddr()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å</button>
    </div>
</section>

<section id="contacts">
    <div style="padding: 40px 20px; text-align: center;">
        <p>–°–≤—è–∑—å –≤ Telegram: <b>@optania</b></p>
        <button class="action-btn" onclick="window.open('https://t.me/optania')">–ù–∞–ø–∏—Å–∞—Ç—å</button>
    </div>
</section>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    function updateTotal() {
        const rows = document.querySelectorAll('#serviceTable tr');
        let totalSum = 0;
        let mainQty = 0;

        rows.forEach(row => {
            const price = parseFloat(row.querySelector('.price').innerText) || 0;
            const qtyInput = row.querySelector('input');
            const qty = parseInt(qtyInput.value) || 0;
            
            // –†–∞—Å—á–µ—Ç: –¶–µ–Ω–∞ * –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
            const rowSum = price * qty;
            row.querySelector('.lineTotal').innerText = rowSum.toFixed(2);
            totalSum += rowSum;

            // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ (–ü—Ä–∏–µ–º–∫–∞)
            if (qtyInput.classList.contains('item-count')) {
                mainQty = qty;
            }
        });

        // –†–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏
        const discountVal = parseFloat(document.getElementById('discount').value) || 0;
        const discountedTotal = totalSum * (1 - discountVal / 100);

        // –í—ã–≤–æ–¥ –∏—Ç–æ–≥–æ–≤
        document.getElementById('finalTotal').innerText = discountedTotal.toFixed(2) + ' ‚ÇΩ';
        
        // –†–∞—Å—á–µ—Ç –∑–∞ –µ–¥–∏–Ω–∏—Ü—É: (–û–±—â–∞—è —Å—É–º–º–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π) / (–ö–æ–ª-–≤–æ –∏–∑ –ø—Ä–∏–µ–º–∫–∏)
        const perItemVal = mainQty > 0 ? (discountedTotal / mainQty).toFixed(2) : '0.00';
        document.getElementById('perItem').innerText = perItemVal;
    }

    function showSection(id, btn) {
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }

    function resetCalc() {
        document.querySelectorAll('input').forEach(i => i.value = "");
        updateTotal();
    }

    function copyAddr() {
        navigator.clipboard.writeText("–≥. –ú–æ—Å–∫–≤–∞, –ß–∞–≥–∏–Ω—Å–∫–∞—è 4 —Å—Ç—Ä 13");
        tg.showAlert("–ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!");
    }

    function sendData() {
        const result = {
            total: document.getElementById('finalTotal').innerText,
            perItem: document.getElementById('perItem').innerText
        };
        tg.sendData(JSON.stringify(result));
    }
</script>
</body>
</html>
